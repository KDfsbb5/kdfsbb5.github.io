<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒªã‚¢ãƒ«ãƒã‚«ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒœãƒ¼ãƒ« 1on1</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9720843068756495" crossorigin="anonymous"></script>
  <style>
    body { margin: 0; background: linear-gradient(to bottom, #87CEEB, #228B22); overflow: hidden; font-family: sans-serif; }
    canvas { display: block; margin: 20px auto; border: 8px solid #FFD700; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); }
    #ui { position: absolute; top: 20px; left: 20px; right: 20px; color: white; font-size: 28px; text-shadow: 3px 3px 6px black; text-align: center; }
    #char-select { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); padding: 30px; border-radius: 30px; text-align: center; color: white; z-index: 100; }
    button { padding: 15px 25px; margin: 10px; background: linear-gradient(#FFD700, #FFA500); border: none; border-radius: 20px; font-size: 20px; cursor: pointer; font-weight: bold; }
    button:hover { transform: scale(1.1); }
    #restart { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); display: none; }
  </style>
</head>
<body>
  <canvas id="canvas" width="900" height="600"></canvas>
  <div id="ui">ã‚­ãƒ£ãƒ©é¸æŠä¸­... | ã‚¹ã‚³ã‚¢: 0 - 0 | å…ˆå–15ç‚¹å‹ã¡ï¼</div>
  <div id="char-select">
    <h2 class="text-4xl mb-8">ğŸ€ ã‚­ãƒ£ãƒ©é¸æŠï¼</h2>
    <button data-char="0">âš¡ ãƒãƒ“é€Ÿ (é€Ÿãƒ‰ãƒªãƒ–ãƒ«)</button><br>
    <button data-char="1">ğŸ¯ ã‚¹ãƒŠã‚¤ãƒ‘ãƒ¼å¾Œè—¤ (3Pç¥)</button><br>
    <button data-char="2">âš–ï¸ æ™®é€šãã‚“ (ãƒãƒ©ãƒ³ã‚¹)</button><br>
    <button data-char="3">ğŸ’ª ã‚´ãƒªãƒ©å±±å´ (ãƒ€ãƒ³ã‚¯ç‹)</button>
  </div>
  <button id="restart" onclick="resetGame()">ğŸ”„ ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ</button>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const ui = document.getElementById('ui');
    const charSelect = document.getElementById('char-select');
    const restartBtn = document.getElementById('restart');

    // ã‚­ãƒ£ãƒ©ãƒ‡ãƒ¼ã‚¿
    const chars = [
      {name: 'ãƒãƒ“é€Ÿ', speed: 9, jump: 16, shootPower: 14, threePt: 0.5, dunkPower: 0, color: '#FF4444'},
      {name: 'ã‚¹ãƒŠã‚¤ãƒ‘ãƒ¼å¾Œè—¤', speed: 5, jump: 14, shootPower: 22, threePt: 0.85, dunkPower: 0, color: '#44AA44'},
      {name: 'æ™®é€šãã‚“', speed: 6.5, jump: 17, shootPower: 16, threePt: 0.6, dunkPower: 0.3, color: '#4444FF'},
      {name: 'ã‚´ãƒªãƒ©å±±å´', speed: 4, jump: 22, shootPower: 12, threePt: 0.2, dunkPower: 1, color: '#FF8800'}
    ];

    let player, ai, ball, score = {p: 0, a: 0}, gameRunning = false, shootCharge = 0, gameOver = false;
    const keys = {};

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã§ãƒã‚°å›é¿
    document.querySelectorAll('#char-select button').forEach(btn => {
      btn.addEventListener('click', () => selectChar(parseInt(btn.dataset.char)));
    });
    document.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
    document.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

    function selectChar(index) {
      player = { ...chars[index], x: 150, y: 450, vx: 0, vy: 0, onGround: true, hasBall: true };
      ai = { ...chars[(index + 1) % 4], x: 700, y: 450, vx: 0, vy: 0, onGround: true, hasBall: false }; // ç•°ãªã‚‹ã‚­ãƒ£ãƒ©
      ball = { x: player.x, y: player.y - 40, vx: 0, vy: 0, r: 15, held: true };
      charSelect.style.display = 'none';
      gameRunning = true;
      gameOver = false;
      ui.textContent = `${player.name} vs ${ai.name} | ã‚¹ã‚³ã‚¢: 0 - 0 | å…ˆå–15ç‚¹ï¼`;
    }

    function drawCourt() {
      ctx.fillStyle = '#8B4513';
      ctx.fillRect(0, 0, 900, 600);
      ctx.strokeStyle = '#FFF';
      ctx.lineWidth = 6;
      ctx.strokeRect(60, 120, 780, 360);
      ctx.beginPath(); ctx.arc(450, 300, 70, 0, Math.PI*2); ctx.stroke();
      ctx.fillStyle = '#FFD700';
      ctx.fillRect(420, 285, 60, 8); // ãƒªãƒ³ã‚°
      ctx.fillRect(400, 220, 20, 70); // ãƒãƒƒã‚¯ãƒœãƒ¼ãƒ‰
    }

    function drawChar(p, flip = false) {
      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.scale(flip ? -1 : 1, 1);
      // ä½“
      ctx.fillStyle = p.color;
      ctx.fillRect(-25, -70, 50, 70);
      // é ­
      ctx.fillStyle = '#FFDAB9';
      ctx.beginPath();
      ctx.arc(0, -55, 15, 0, Math.PI*2);
      ctx.fill();
      // ç›®
      ctx.fillStyle = '#000';
      ctx.fillRect(-5, -60, 4, 4);
      ctx.fillRect(5, -60, 4, 4);
      // ãƒ‰ãƒªãƒ–ãƒ«ã‚¢ãƒ‹ãƒ¡
      if (p.hasBall && p.onGround) {
        ctx.fillStyle = '#FFAA00';
        ctx.beginPath();
        ctx.arc(20, -20 + Math.sin(Date.now() / 100) * 10, 12, 0, Math.PI*2);
        ctx.fill();
      }
      ctx.restore();
      // åå‰
      ctx.fillStyle = '#FFF';
      ctx.font = 'bold 18px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(p.name, p.x, p.y - 85);
    }

    function drawBall() {
      if (!ball.held) {
        ctx.fillStyle = '#FFAA00';
        ctx.beginPath();
        ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
        ctx.fill();
        ctx.strokeStyle = '#FFF';
        ctx.lineWidth = 3;
        ctx.stroke();
      }
    }

    function updatePlayer() {
      if (!gameRunning || gameOver) return;
      player.vx *= 0.85;
      if (keys['arrowleft']) player.vx = -player.speed;
      if (keys['arrowright']) player.vx = player.speed;
      if (keys['arrowup'] && player.onGround) {
        player.vy = -player.jump;
        player.onGround = false;
      }
      // ã‚·ãƒ¥ãƒ¼ãƒˆ
      if (keys['x']) {
        shootCharge = Math.min(shootCharge + 0.5, 20);
      } else if (shootCharge > 0 && player.hasBall) {
        ball.vx = (450 - player.x) / (40 - shootCharge * 0.5);
        ball.vy = - (player.shootPower + shootCharge * 0.3);
        ball.held = false;
        player.hasBall = false;
        shootCharge = 0;
      }
      // ãƒ€ãƒ³ã‚¯
      if (keys[' '] && player.hasBall && player.dunkPower > 0 && Math.abs(player.x - 450) < 50 && player.y < 350) {
        score.p += 2;
        ui.textContent = `${player.name} vs ${ai.name} | ã‚¹ã‚³ã‚¢: ${score.p} - ${score.a}`;
        resetBall();
        checkGameOver();
      }
      player.x += player.vx;
      player.y += player.vy;
      player.vy += 0.8;
      if (player.y >= 450) { player.y = 450; player.vy = 0; player.onGround = true; }
      player.x = Math.max(40, Math.min(860, player.x));
      if (player.hasBall && ball.held) {
        ball.x = player.x;
        ball.y = player.y - 40;
      }
    }

    function updateAI() {
      if (!gameRunning || gameOver) return;
      const dx = (player.hasBall ? player.x : ball.x) - ai.x;
      ai.vx = Math.sign(dx) * ai.speed * 0.7;
      if (Math.random() < 0.015 && ai.hasBall) {
        ball.vx = (450 - ai.x) / 40;
        ball.vy = -ai.shootPower;
        ai.hasBall = false;
        ball.held = false;
      }
      // ãƒ–ãƒ­ãƒƒã‚¯
      if (Math.abs(player.x - ai.x) < 50 && player.y < 350 && Math.random() < 0.02) {
        player.vy = 5;
      }
      ai.x += ai.vx;
      ai.y += ai.vy;
      ai.vy += 0.8;
      if (ai.y >= 450) { ai.y = 450; ai.vy = 0; ai.onGround = true; }
      ai.x = Math.max(40, Math.min(860, ai.x));
      if (ai.hasBall && ball.held) 
