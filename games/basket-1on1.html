<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>リアルバカストリートボール 1on1</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9720843068756495" crossorigin="anonymous"></script>
  <style>
    body { margin: 0; background: linear-gradient(#87CEEB, #228B22); overflow: hidden; font-family: sans-serif; }
    canvas { display: block; margin: 20px auto; border: 5px solid #FFD700; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
    #ui { position: absolute; top: 20px; left: 20px; color: white; font-size: 28px; text-shadow: 2px 2px 4px black; }
    #char-select { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.8); padding: 20px; border-radius: 20px; text-align: center; color: white; }
    button { padding: 10px 20px; margin: 10px; background: #FFD700; border: none; border-radius: 10px; font-size: 18px; cursor: pointer; }
    button:hover { background: #FFA500; }
  </style>
</head>
<body>
  <canvas id="canvas" width="800" height="500"></canvas>
  <div id="ui">スコア: 0 - 0</div>
  <div id="char-select">
    <h2 class="text-3xl mb-4">キャラ選択！</h2>
    <button onclick="selectChar(0)">チビ速 (スピード)</button>
    <button onclick="selectChar(1)">スナイパー後藤 (シューター)</button>
    <button onclick="selectChar(2)">普通くん (バランス)</button>
    <button onclick="selectChar(3)">ゴリラ山崎 (パワー)</button>
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const ui = document.getElementById('ui');
    const charSelect = document.getElementById('char-select');

    // キャラデータ
    const chars = [
      {name: 'チビ速', speed: 8, jump: 18, shoot: 15, dunk: false, color: '#FF4444', anim: ['走る', 'ジャンプ', 'シュート']},
      {name: 'スナイパー後藤', speed: 5, jump: 16, shoot: 20, dunk: false, color: '#44AA44', anim: ['スタンド', 'シュート']},
      {name: '普通くん', speed: 6, jump: 17, shoot: 16, dunk: false, color: '#4444FF', anim: ['走る', 'シュート']},
      {name: 'ゴリラ山崎', speed: 4, jump: 20, shoot: 12, dunk: true, color: '#FF8800', anim: ['ゴリ押し', 'ダンク']}
    ];

    let player, ai, ball, score = {p:0, a:0}, selected = false, gameStart = false;

    const keys = {};
    document.addEventListener('keydown', e => keys[e.key] = true);
    document.addEventListener('keyup', e => keys[e.key] = false);

    function selectChar(index) {
      player = {...chars[index], x:100, y:400, vx:0, vy:0, hasBall:true};
      ai = {...chars[Math.floor(Math.random()*4)], x:700, y:400, vx:0, vy:0, hasBall:false};
      ball = {x:player.x+20, y:player.y-30, vx:0, vy:0, r:12};
      charSelect.style.display = 'none';
      gameStart = true;
      loop();
    }

    function drawCourt() {
      ctx.fillStyle = '#8B4513';
      ctx.fillRect(0,0,800,500);
      ctx.strokeStyle = '#FFF';
      ctx.lineWidth = 4;
      ctx.strokeRect(50,100,700,300);
      ctx.beginPath(); ctx.arc(400,250,50,0,Math.PI*2); ctx.stroke();
      ctx.fillStyle = '#FFD700';
      ctx.fillRect(380,240,40,10); // リング
      ctx.fillRect(380,200,10,40); // バックボード
    }

    function drawPlayer(p, isPlayer) {
      ctx.fillStyle = p.color;
      ctx.fillRect(p.x-20, p.y-60, 40, 60); // 体
      ctx.fillStyle = '#FFF';
      ctx.font = 'bold 16px sans-serif';
      ctx.fillText(p.name, p.x-30, p.y-70);
      if (p.hasBall) {
        ctx.fillStyle = '#FFA500';
        ctx.beginPath(); ctx.arc(p.x+20, p.y-30, 12,0,Math.PI*2); ctx.fill();
      }
    }

    function updatePlayer() {
      if (keys['ArrowLeft']) player.vx = -player.speed;
      if (keys['ArrowRight']) player.vx = player.speed;
      if (keys['ArrowUp'] && player.vy === 0) player.vy = -player.jump;
      if (keys['z'] && player.hasBall) { // パス
        ball.vx = (ai.x - player.x) / 50;
        ball.vy = -5;
        player.hasBall = false;
        ai.hasBall = true;
      }
      if (keys['x'] && player.hasBall && player.vy === 0) { // シュート
        ball.vx = (400 - player.x) / 50 + (Math.random()-0.5)*2;
        ball.vy = -player.shoot - (400 - player.x)/100;
        player.hasBall = false;
      }
      if (keys[' '] && player.hasBall && player.dunk && Math.abs(player.x-400)<50) { // ダンク
        ball.vy = -5;
        score.p += 2;
        resetBall();
      }
      player.x += player.vx;
      player.y += player.vy;
      player.vy += 0.8; // 重力
      if (player.y >= 400) { player.y = 400; player.vy = 0; }
      player.x = Math.max(0, Math.min(800, player.x));
      if (player.hasBall) { ball.x = player.x+20; ball.y = player.y-30; }
    }

    function updateAI() {
      // AI追従
      ai.vx = (player.x - ai.x > 0 ? 1 : -1) * ai.speed * 0.7;
      if (Math.random() < 0.02 && ai.hasBall) {
        ball.vx = (400 - ai.x)/50 + (Math.random()-0.5)*3;
        ball.vy = -ai.shoot;
        ai.hasBall = false;
      }
      ai.x += ai.vx;
      ai.y += ai.vy;
      ai.vy += 0.8;
      if (ai.y >= 400) { ai.y = 400; ai.vy = 0; }
      if (ai.hasBall) { ball.x = ai.x-20; ball.y = ai.y-30; }
    }

    function updateBall() {
      if (!player.hasBall && !ai.hasBall) {
        ball.x += ball.vx;
        ball.y += ball.vy;
        ball.vy += 0.8;

        // バウンド
        if (ball.y > 480) { ball.y = 480; ball.vy *= -0.7; ball.vx *= 0.8; }

        // リング衝突
        if (ball.y > 240 && ball.y < 260 && ball.x > 380 && ball.x < 420 && ball.vy > 0) {
          if (Math.abs(ball.vx) < 3) { // 成功
            score[player.hasBall ? 'a' : 'p'] += (Math.abs(ball.vx) < 1 ? 3 : 2);
            ui.textContent = `スコア: ${score.p} - ${score.a}`;
            resetBall();
            if (score.p >= 15 || score.a >= 15) alert(`${score.p >= 15 ? '勝ったぜ！' : '負けた...'} リスタート！`);
          } else { // リムに当たる
            ball.vx *= -0.5;
            ball.vy *= -0.5;
          }
        }

        // 奪い合い
        if (Math.abs(ball.x - player.x) < 40 && Math.abs(ball.y - player.y) < 40 && !ai.hasBall) player.hasBall = true;
        if (Math.abs(ball.x - ai.x) < 40 && Math.abs(ball.y - ai.y) < 40 && !player.hasBall) ai.hasBall = true;
      }
    }

    function resetBall() {
      ball.x = 400; ball.y = 200; ball.vx = 0; ball.vy = 0;
      player.hasBall = true; ai.hasBall = false;
    }

    function loop() {
      if (!gameStart) return;
      ctx.clearRect(0,0,800,500);
      drawCourt();
      drawPlayer(player);
      drawPlayer(ai, false);
      updatePlayer();
      updateAI();
      updateBall();
      requestAnimationFrame(loop);
    }

    // AdSense
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <!-- 下部広告 -->
  <ins class="adsbygoogle" style="display:block; margin:20px auto;" data-ad-format="auto" data-full-width-responsive="true"></ins>
  <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</body>
</html>
