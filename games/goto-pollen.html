<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ÂæåËó§„Åï„ÇìËä±Á≤â„Ç∑„É•„Éº„Çø„Éº</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9720843068756495" crossorigin="anonymous"></script>
  <style>
    body { margin: 0; background: linear-gradient(to bottom, #87CEEB 0%, #90EE90 70%, #228B22 100%); overflow: hidden; font-family: sans-serif; }
    canvas { display: block; margin: 20px auto; border: 8px solid #FFD700; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
    #ui { position: absolute; top: 10px; left: 20px; color: #FFD700; font-size: 28px; font-weight: bold; text-shadow: 2px 2px 4px #333; }
    #restart { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); padding: 15px 40px; background: linear-gradient(#FF69B4, #FFD700); border: none; border-radius: 50px; font-size: 24px; cursor: pointer; display: none; }
  </style>
</head>
<body>
  <canvas id="canvas" width="800" height="500"></canvas>
  <div id="ui">
    <div>„Çπ„Ç≥„Ç¢: <span id="score">0</span></div>
    <div>‰ΩìÂäõ: <span id="health">100</span></div>
  </div>
  <button id="restart" onclick="resetGame()">üå∏ „É™„Çπ„Çø„Éº„ÉàÔºÅ</button>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const healthEl = document.getElementById('health');
    const restartBtn = document.getElementById('restart');

    // ÂæåËó§„Åï„Çì
    let gotou = { x: 400, y: 420, width: 60, height: 80, speed: 8 };

    let pollens = []; // Ëä±Á≤âÂºæ
    let enemies = []; // Êïµ
    let score = 0;
    let health = 100;
    let gameOver = false;
    let shootCooldown = 0;
    let shootCharge = 0;

    const keys = {};
    document.addEventListener('keydown', e => keys[e.key] = true);
    document.addEventListener('keyup', e => keys[e.key] = false);

    function drawGotou() {
      // ‰Ωì („Éî„É≥„ÇØ)
      ctx.fillStyle = '#FF69B4';
      ctx.fillRect(gotou.x - gotou.width/2, gotou.y - gotou.height, gotou.width, gotou.height);
      // Èºª (Áô∫Â∞ÑÂè£„ÄÅ„ÉÅ„É£„Éº„Ç∏„ÅßÂÖâ„Çã)
      ctx.fillStyle = shootCharge > 0 ? '#FFFF00' : '#FFD700';
      ctx.shadowColor = '#FFFF00';
      ctx.shadowBlur = shootCharge * 2;
      ctx.fillRect(gotou.x - 8, gotou.y - 35, 16, 25);
      ctx.shadowBlur = 0;
      // ÁõÆ&Âè£
      ctx.fillStyle = '#000';
      ctx.fillRect(gotou.x - 18, gotou.y - 55, 10, 10);
      ctx.fillRect(gotou.x + 8, gotou.y - 55, 10, 10);
      ctx.font = 'bold 20px sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('ÂæåËó§„Åï„Çì', gotou.x, gotou.y - gotou.height - 10);
    }

    function drawPollen(p) {
      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.angle);
      ctx.fillStyle = '#FFD700';
      ctx.shadowColor = '#FFA500';
      ctx.shadowBlur = 15;
      ctx.beginPath();
      ctx.arc(0, 0, p.r, 0, Math.PI*2);
      ctx.fill();
      ctx.shadowBlur = 0;
      ctx.restore();
    }

    function drawEnemy(e) {
      ctx.fillStyle = e.color;
      ctx.shadowColor = '#FF0000';
      ctx.shadowBlur = 10;
      ctx.beginPath();
      ctx.arc(e.x, e.y, e.r, 0, Math.PI*2);
      ctx.fill();
      ctx.shadowBlur = 0;
      // ÈºªÊ∞¥Êª¥
      ctx.fillStyle = '#00BFFF';
      ctx.fillRect(e.x - 5, e.y + e.r - 5, 10, 15);
    }

    function update() {
      if (gameOver) return;

      // ÂæåËó§ÁßªÂãï (Â∑¶Âè≥)
      if (keys['arrowleft']) gotou.x -= gotou.speed;
      if (keys['arrowright']) gotou.x += gotou.speed;
      gotou.x = Math.max(30, Math.min(770, gotou.x));

      // Ëä±Á≤âÁô∫Â∞Ñ („Çπ„Éö„Éº„ÇπÈÄ£Êâì + „ÉÅ„É£„Éº„Ç∏)
      if (keys[' '] && shootCooldown <= 0) {
        shootCharge = Math.min(shootCharge + 1, 20);
      }
      if (!keys[' '] && shootCharge > 5) {
        const power = 8 + shootCharge * 0.5;
        pollens.push({ x: gotou.x, y: gotou.y - 35, vx: (Math.random()-0.5)*3, vy: -power, r: 8 + shootCharge/4, angle: 0 });
        shootCooldown = 8 - shootCharge/5; // „ÉÅ„É£„Éº„Ç∏Èï∑„ÇÅ„ÅßÈÄ£Â∞ÑÈÄü„Åè
        shootCharge = 0;
      }
      if (shootCooldown > 0) shootCooldown--;

      // Ëä±Á≤âÊõ¥Êñ∞
      pollens.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.2;
        p.angle += 0.2;
        p.r *= 0.99;
      });
      pollens = pollens.filter(p => p.y < 500 && p.r > 1);

      // ÊïµÁîüÊàê („Çπ„Ç≥„Ç¢„ÅßÂ¢óÂä†)
      if (Math.random() < 0.04 + score * 0.0002) {
        enemies.push({
          x: Math.random() * 760 + 20,
          y: -30,
          vx: (Math.random() - 0.5) * 3,
          vy: 3 + Math.random() * 2,
          r: 15 + Math.random() * 20,
          color: `hsl(${180 + Math.random()*60}, 70%, 50%)`
        });
      }

      // ÊïµÊõ¥Êñ∞ & Ë°ùÁ™Å
      enemies.forEach((e, i) => {
        e.x += e.vx;
        e.y += e.vy;
        e.vy += 0.15;
        e.x = Math.max(e.r, Math.min(800 - e.r, e.x));

        // Âú∞Èù¢Âà∞ÈÅî or ÂæåËó§Êé•Ëß¶ ‚Üí „ÉÄ„É°„Éº„Ç∏
        if (e.y + e.r > gotou.y - gotou.height || e.y > 500) {
          health -= Math.ceil(e.r / 5);
          healthEl.textContent = health;
          enemies.splice(i, 1);
          if (health <= 0) {
            gameOver = true;
            restartBtn.style.display = 'block';
          }
          return;
        }

        // Ëä±Á≤âË°ùÁ™Å ‚Üí ÁàÜÁô∫„Çπ„Ç≥„Ç¢
        pollens.forEach((p, j) => {
          const dist = Math.hypot(e.x - p.x, e.y - p.y);
          if (dist < e.r + p.r) {
            score += Math.floor(e.r * p.r / 10);
            scoreEl.textContent = score;
            enemies.splice(i, 1);
            pollens.splice(j, 1);
          }
        });
      });

      // ÊèèÁîª
      ctx.clearRect(0, 0, 800, 500);
      drawGotou();
      pollens.forEach(drawPollen);
      enemies.forEach(drawEnemy);

      requestAnimationFrame(update);
    }

    function resetGame() {
      score = 0; health = 100;
      pollens = []; enemies = [];
      gotou.x = 400;
      gameOver = false;
      scoreEl.textContent = '0';
      healthEl.textContent = '100';
      restartBtn.style.display = 'none';
      shootCharge = 0; shootCooldown = 0;
    }

    (adsbygoogle = window.adsbygoogle || []).push({});
    update();
  </script>
  <ins class="adsbygoogle" style="display:block; margin:20px auto;" data-ad-format="auto" data-full-width-responsive="true"></ins>
  <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</body>
</html>
